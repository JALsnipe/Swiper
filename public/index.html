<!DOCTYPE html> 
<html> 
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Swiper</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">

  <!-- CSS imports -->
  <link rel="stylesheet" href="css/bootstrap.css">
  <!-- Used FontAwesome for my icons. -->
  <link href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">

  <!-- Scripts -->
  <!-- js imports -->
  <script type="text/javascript" src="js/vendor/jquery-1.10.1.min.js"></script>
  <script type="text/javascript" src="js/bootstrap.js"></script>
  <!-- // <script src="js/main.js"></script> -->
  <script src="js/vendor/modernizr-2.6.2.min.js"></script>
  <script type="text/javascript" src="js/canvas.text.js"></script>
  <script type="text/javascript" src="js/gentilis-normal-normal.js"></script>
  <script type="text/javascript" src="js/dollar.js"></script>
  <script type="text/javascript"><!--
      //
    // Startup
    //
    var _isDown, _points, _r, _g, _rc;
    function onLoadEvent()
    {
      _points = new Array();
      _r = new DollarRecognizer();

      var canvas = document.getElementById('myCanvas');
      _g = canvas.getContext('2d');
      _g.fillStyle = "rgb(0,0,225)";
      _g.strokeStyle = "rgb(0,0,225)";
      _g.lineWidth = 3;
      _g.font = "16px Gentilis";
      _rc = getCanvasRect(canvas); // canvas rect on page
      _g.fillStyle = "rgb(255,255,136)";
      _g.fillRect(0, 0, _rc.width, 20);

      _isDown = false;
    }
    function getCanvasRect(canvas)
    {
      var w = canvas.width;
      var h = canvas.height;

      var cx = canvas.offsetLeft;
      var cy = canvas.offsetTop;
      while (canvas.offsetParent != null)
      {
        canvas = canvas.offsetParent;
        cx += canvas.offsetLeft;
        cy += canvas.offsetTop;
      }
      return {x: cx, y: cy, width: w, height: h};
    }
    function getScrollY()
    {
      var scrollY = 0;
      if (typeof(document.body.parentElement) != 'undefined')
      {
        scrollY = document.body.parentElement.scrollTop; // IE
      }
      else if (typeof(window.pageYOffset) != 'undefined')
      {
        scrollY = window.pageYOffset; // FF
      }
      return scrollY;
    }
    //
    // Mouse Events
    //
    function mouseDownEvent(x, y)
    {
      document.onselectstart = function() { return false; } // disable drag-select
      document.onmousedown = function() { return false; } // disable drag-select
      _isDown = true;
      x -= _rc.x;
      y -= _rc.y - getScrollY();
      if (_points.length > 0)
        _g.clearRect(0, 0, _rc.width, _rc.height);
      _points.length = 1; // clear
      _points[0] = new Point(x, y);
      drawText("Recording unistroke...");
      _g.fillRect(x - 4, y - 3, 9, 9);
    }
    function mouseMoveEvent(x, y)
    {
      if (_isDown)
      {
        x -= _rc.x;
        y -= _rc.y - getScrollY();
        _points[_points.length] = new Point(x, y); // append
        drawConnectedPoint(_points.length - 2, _points.length - 1);
      }
    }
    function mouseUpEvent(x, y)
    {
      document.onselectstart = function() { return true; } // enable drag-select
      document.onmousedown = function() { return true; } // enable drag-select
      if (_isDown)
      {
        _isDown = false;
        if (_points.length >= 10)
        {
          // var result = _r.Recognize(_points, document.getElementById('useProtractor').checked);
          var result = _r.Recognize(_points);
          drawText("Result: " + result.Name + " (" + round(result.Score,2) + ").");
          // TEST!!
          if(result.Name == "check")
          {
            playPause();
          }

          if(result.Name == "delete")
          {
            mute();
          }

          if(result.Name == 'caret')
          {
            volUp();
          }

          if(result.Name == 'v')
          {
            volDown();
          }
        }
        else // fewer than 10 points were inputted
        {
          drawText("Too few points made. Please try again.");
        }
      }
    }
    function drawText(str)
    {
      _g.fillStyle = "rgb(255,255,136)";
      _g.fillRect(0, 0, _rc.width, 20);
      _g.fillStyle = "rgb(0,0,255)";
      _g.fillText(str, 1, 14);
    }
    function drawConnectedPoint(from, to)
    {
      _g.beginPath();
      _g.moveTo(_points[from].X, _points[from].Y);
      _g.lineTo(_points[to].X, _points[to].Y);
      _g.closePath();
      _g.stroke();
    }
    function round(n, d) // round 'n' to 'd' decimals
    {
      d = Math.pow(10, d);
      return Math.round(n * d) / d
    }
    //
    // Unistroke Adding and Clearing
    //
    function onClickAddExisting()
    {
      if (_points.length >= 10)
      {
        var unistrokes = document.getElementById('unistrokes');
        var name = unistrokes[unistrokes.selectedIndex].value;
        var num = _r.AddGesture(name, _points);
        drawText("\"" + name + "\" added. Number of \"" + name + "\"s defined: " + num + ".");
      }
    }
    function onClickAddCustom()
    {
      var name = document.getElementById('custom').value;
      if (_points.length >= 10 && name.length > 0)
      {
        var num = _r.AddGesture(name, _points);
        drawText("\"" + name + "\" added. Number of \"" + name + "\"s defined: " + num + ".");
      }
    }
    function onClickCustom()
    {
      document.getElementById('custom').select();
    }
    function onClickDelete()
    {
      var num = _r.DeleteUserGestures(); // deletes any user-defined unistrokes
      alert("All user-defined gestures have been deleted. Only the 1 predefined gesture remains for each of the " + num + " types.");
    }
  // -->
  </script>
</head>
<body onload="onLoadEvent()">

  <nav class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" rel="home" href="#" title="Swiper"><img style="max-width:50px; margin-top: -7px;" src="images/swiper-thumb.jpg">
        </a>
</div>
      <!-- <a class="navbar-brand" href="#">Swiper</a> -->
    </div>
  </nav>
  <div class="bs-header" id="content">
    <div class="container">
      <h1>
        Swiper
      </h1>
      <p>
        No Typing, Just Swiping
      </p>
    </div>
  </div>

<div class="main"> 
  <div class="video">
  <!-- <video id="video1" width="320" height="240"> -->
    <video id="video1" width="320">
    <!-- <source src="police.mp4" type="video/mp4"> -->
    <source src="reruns.mp4" type="video/mp4">
    <!-- <source src="mov_bbb.ogg" type="video/ogg"> -->
    <!-- ogg movie support required? -->
    Your browser does not support HTML5 video.
  </video>
  <div class="canvas">
    <!-- <canvas id="myCanvas" width="420" height="400" style="background-color:#dddddd" -->
    <canvas id="myCanvas" width="320" height="240"
                    onmousedown="mouseDownEvent(event.clientX, event.clientY)"
                    onmousemove="mouseMoveEvent(event.clientX, event.clientY)"
                    onmouseup="mouseUpEvent(event.clientX, event.clientY)"
                    oncontextmenu="return false;">
                  <span style="background-color:#ffff88;">The &lt;canvas&gt; element is not supported by this browser.</span>
                </canvas>
  </div>
</div>

  <div class="debug">
    <h1>DEBUG</h1>
    <img src="unistrokes.gif">
    <p>
      <button onclick="playPause()">Play/Pause</button> 
      <button onclick="increaseWidth()">Increase Width (+10px)</button>
      <button onclick="decreaseWidth()">Decrease Width (-10px)</button>
      <button onclick="makeNormal()">Revert to Normal Size</button>
      <button onclick="increaseHeight()">Increase Height (+10px)</button>
      <button onclick="decreaseHeight()">Decrease Height (-10px)</button>
      <button onclick="mute()">Mute/Unmute</button>
      <!-- <button onclick="unmute()">Unute</button> -->
      <button onclick="decreaseSpeed()">Decrease Speed</button>
      <button onclick="normalSpeed()">Normal Speed</button>
      <button onclick="increaseSpeed()">Increase Speed</button>
      <button onclick="ffTenSec()">FF 10 sec</button>
      <button onclick="rewTenSec()">REW 10 sec</button>
      <button onclick="volUp()">Volume +0.1</button>
      <button onclick="volDown()">Volume -0.1</button>
    </p>
    <p>
      Anything going wrong?  Check the JavaScript console.
    </p>

    <p>
      Please note that this is still in alpha...
    </p>

    <p>
      Current gestures supported:

      "check" = play/pause
      "delete" = mute/unmute
      "carrot" = volume up
      "v" = volume down
    </p>

    <p>
      The buttons up top are for debugging.  Not all gestures are supported yet.
    </p>

    <p>
      Reruns suck but there's no escape.  99's gonna be a party, hang out...
    </p>
  </div>

</div> 

<script> 
var myVideo=document.getElementById("video1"); 

function playPause()
{ 
if (myVideo.paused) 
  myVideo.play(); 
else 
  myVideo.pause(); 
} 

function increaseWidth()
{ 
  myVideo.width+=10; 
} 

function decreaseWidth()
{ 
  myVideo.width-=10; 
} 

function makeNormal()
{ 
  myVideo.width=320;
  // myVideo.height=240;
  // console.log("reverting to 320px x 240px")
} 

function increaseHeight()
{ 
  myVideo.height+=10; 
  // myVideo.width=auto;
} 

function decreaseHeight()
{ 
  myVideo.height-=10; 
} 

function mute()
{ 
  if(myVideo.muted)
    myVideo.muted=false;
  else
    myVideo.muted=true;
}

function decreaseSpeed()
{ 
  myVideo.playbackRate-=0.1; 
} 

function normalSpeed()
{ 
  myVideo.playbackRate=1.0; 
} 

function increaseSpeed()
{ 
  myVideo.playbackRate+=0.1; 
} 
// Working now
function ffTenSec()
{ 
  myVideo.currentTime+=10;
} 

function rewTenSec()
{
  myVideo.currentTime-=10;
}

function volUp()
{
  if(myVideo.volume == 1.0)
  {
    console.log("Volume already at max value! (1.0)")
  } else
  {
  myVideo.volume+=0.1;
  console.log("myVideo.volume+=0.1");
  console.log("curent volume: " + myVideo.volume);
  }
}

function volDown()
{
  if(myVideo.volume < 0.1)
  {
    console.log("Volume already at min value! (0.0)")
  } else
  {
  myVideo.volume-=0.1;
  console.log("myVideo.volume-=0.1");
  console.log("curent volume: " + myVideo.volume);
  }
}

</script> 

</body> 
</html>